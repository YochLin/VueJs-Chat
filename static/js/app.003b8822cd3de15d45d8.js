webpackJsonp([1],{"0HD6":function(e,t,s){e.exports=s.p+"static/img/upload.6319546.png"},JcHB:function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("7+uW"),i={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[this._m(0),this._v(" "),t("router-view")],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h1",[t("b",[this._v("上傳圖片與讀取未完成")])])}]};var r=s("VU/8")({name:"App"},i,!1,function(e){s("Wn9Q")},null,null).exports,n=s("/ocq"),o=s("kxiW"),m=s.n(o);m.a.initializeApp({apiKey:"AIzaSyD4BeOXxM0npxuZZFLG26-UOKwp8ELHTQo",authDomain:"yoch-6b6be.firebaseapp.com",databaseURL:"https://yoch-6b6be.firebaseio.com",projectId:"yoch-6b6be",storageBucket:"yoch-6b6be.appspot.com",messagingSenderId:"698152557825"});var c=m.a.database().ref("/messages/"),u=m.a.storage().ref("/images/"),l={name:"ChatRoom",data:function(){return{userName:"",messages:[],userNameSet:!1,upload:!1,progress:""}},methods:{setName:function(){this.userNameSet=!0},saveName:function(){var e=document.querySelector("#js-userName").value;""!==e.trim()&&(this.userName=e,this.userNameSet=!1)},getTime:function(){var e=new Date,t=e.getHours(),s=e.getMinutes();return(t>=12?"下午":"上午")+" "+t+":"+(s<10?"0"+s:s)},sendMessage:function(e){var t=document.querySelector("#js-userName"),s=document.querySelector("#js-message");return!e.shiftKey&&(s.value.length<=1&&""===s.value.trim()?(e.preventDefault(),!1):(c.push({userName:t.value,type:"text",message:s.value,timeStamp:this.getTime()}),s.value="",void e.preventDefault()))},sendImage:function(e){var t=this,s=document.querySelector("#js-userName"),a=e.target.files[0],i=Math.floor(Date.now()/1e3)+"_"+a.name,r=document.querySelector("#js-progressBar"),n=u.child("images/"+i).put(a,{contentType:"image/*"});n.on(m.a.storage.TaskEvent.STATE_CHANGED,function(e){var s=Math.floor(e.bytesTransferred/e.totalBytes*100);s<100&&(t.upload=!0,t.progress=s+"%",r.setAttribute("style","width:"+s+"%"))},function(e){c.child("bug/").push({userName:s.value,type:"image",message:e.code,timeStamp:t.getTime()})},function(){var e=n.snapshot.downloadURL;c.push({userName:s.value,type:"image",message:e,timeStamp:t.getTime()}),t.upload=!1})}},mounted:function(){var e=this;c.on("value",function(t){var s=t.val();e.messages=s})},updated:function(){var e=document.querySelector(".chatBody");e.scrollTop=e.scrollHeight}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"name"},[a("h3",[e._v("Name : "+e._s(e.userName))]),e._v(" "),a("div",{staticClass:"reset",on:{click:function(t){e.setName()}}},[e._v("Reset Name")])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.userNameSet||""==e.userName,expression:"userNameSet || userName == ''"}],staticClass:"modal"},[a("div",{staticClass:"modal_container"},[e._m(0),e._v(" "),a("div",{staticClass:"modal_body"},[a("input",{staticClass:"userName",attrs:{type:"text",id:"js-userName"},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.saveName()}}}),e._v(" "),a("button",{staticClass:"button",on:{click:function(t){e.saveName()}}},[e._v("設定")])])])]),e._v(" "),a("div",{staticClass:"chatRoom"},[e._m(1),e._v(" "),a("div",{staticClass:"chatBody"},e._l(e.messages,function(t){return a("div",{key:t},[t.userName!=e.userName?a("div",[a("div",{staticClass:"message-box"},[a("img",{attrs:{src:"https://lorempixel.com/40/40/",alt:"頭貼"}}),e._v(" "),a("div",{staticClass:"message-content"},[a("div",{staticClass:"message-name"},[e._v(e._s(t.userName))]),e._v(" "),"text"==t.type?a("div",{staticClass:"message-text"},[a("div",{staticClass:"message-message"},[e._v(e._s(t.message))])]):e._e(),e._v(" "),a("div",{staticClass:"message-time"},[e._v(e._s(t.timeStamp))]),e._v(" "),"image"==t.type?a("div",{staticClass:"message-image"},[a("img",{attrs:{src:t.message}})]):e._e()])])]):e._e(),e._v(" "),t.userName==e.userName?a("div",[a("div",{staticClass:"message-box message-user"},[a("div",{staticClass:"message-content"},[a("div",{staticClass:"message-time"},[e._v(e._s(t.timeStamp))]),e._v(" "),"text"==t.type?a("div",{staticClass:"message-text"},[a("div",{staticClass:"message-message"},[e._v(e._s(t.message))])]):e._e(),e._v(" "),"image"==t.type?a("div",{staticClass:"message-image"},[a("img",{attrs:{src:t.message}})]):e._e()])])]):e._e()])})),e._v(" "),a("div",{staticClass:"loadDataArea"},[a("div",{staticClass:"loadData"},[a("input",{attrs:{type:"file",multiple:"",accept:"image/*"},on:{change:function(t){e.sendImage(t)}}}),e._v(" "),a("img",{attrs:{src:s("0HD6"),alt:""}})])]),e._v(" "),a("div",{staticClass:"ChatArea"},[a("textarea",{staticClass:"ChatArea-message",attrs:{id:"js-message"},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.sendMessage(t)}}})])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"modal_header"},[t("header",[this._v("輸入名稱")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"chatHeader uk-flex uk-flex-left"},[t("img",{staticClass:"room-image",attrs:{src:"https://lorempixel.com/50/50/",draggable:"true",alt:"頭貼"}}),this._v(" "),t("div",{staticClass:"room-title"},[this._v("聊天室")])])}]};var d=s("VU/8")(l,v,!1,function(e){s("JcHB")},"data-v-5ec51c36",null).exports;a.a.use(n.a);var p=new n.a({routes:[{path:"/",name:"ChatRoom",component:d}]});a.a.config.productionTip=!1,new a.a({el:"#app",router:p,components:{App:r},template:"<App/>"})},Wn9Q:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.003b8822cd3de15d45d8.js.map